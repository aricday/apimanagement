<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
        <l7:Bundle xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management">
            <l7:References>
                <l7:Item>
                    <l7:Name>mas.docker.local</l7:Name>
                    <l7:Id>8c5ae07247f7a3f5d5fdcc3926f2eeb6</l7:Id>
                    <l7:Type>TRUSTED_CERT</l7:Type>
                    <l7:TimeStamp>2019-05-01T13:46:37.727Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:TrustedCertificate id="8c5ae07247f7a3f5d5fdcc3926f2eeb6" version="0">
                            <l7:Name>mas.docker.local</l7:Name>
                            <l7:CertificateData>
                                <l7:IssuerName>CN%3Dmas.docker.local</l7:IssuerName>
                                <l7:SerialNumber>9830121966467924271</l7:SerialNumber>
                                <l7:SubjectName>CN%3Dmas.docker.local</l7:SubjectName>
                                <l7:Encoded>MIIFJjCCAw6gAwIBAgIJAIhrm9imFcEvMA0GCSqGSIb3DQEBBQUAMBsxGTAXBgNVBAMMEG1hcy5kb2NrZXIubG9jYWwwHhcNMTcwNzA2MTkxOTEwWhcNMTkwNzA2MTkxOTEwWjAbMRkwFwYDVQQDDBBtYXMuZG9ja2VyLmxvY2FsMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA3h8BYvPsnCXz0juXMSGiHz2fct8qpIhHzRxc44LmY17gYWI9A+cpi30qFrFEHXT0YpYm2ed6T7bprfW1RpcW40q5gujhLukMFQlmnutzKNe0AowrDoDNKIpCGlJImb72nNRyF8kML0ANDLDoC1vztUM4esMh+fPUyaIoA23GVmobnUtr5H865s4bKbUArTSPIr5GPkhGTAOx05lBq+tX8P0RcyXPdahWoDmooWrseByyslebPD4q9UagKQxbPRZEVZjzZC6k/LJZa9+OY4n1F8tfEuMB5SKlrNBKqj1dcqVElNzCLAp+lR9FYYYz+r9VB/6qwkMguWed+koVuvhfRZWIavFJHARiVPwn5R68Q25sQkxNwUHE6/PwEHUxe4biKIHg/HgLMa6Mb8BhlifYz6M5W3T/ro9SNeid5hGNa77svNYl+i9lZEPfDDAfa5lTAILVCB4d5CvfoT9XZYei/2agIqyhWbKDUQv9Y05MR2agcSQQ0HPAUmhvOdzjpHx6RVJ4MSnvz51iXrrAGGPgaaxaxT+7sNJ4zisHVNd2aE5o8/e3EGDgSy7pttEE+VBD3kKXcAHNZqV8/kHjBBQb4kPGQqfQiWmlZBYZ+jpORJgK0U4dZxZLuXBUTd6qOnc9oOCtuaeUWtyevB1w7/eL3XKY5O3FR9/GMsFmX7Y4qA8CAwEAAaNtMGswGwYDVR0RBBQwEoIQbWFzLmRvY2tlci5sb2NhbDAdBgNVHQ4EFgQUsGqxJDURn0ol94M4SAjKa8iW5VowHwYDVR0jBBgwFoAUsGqxJDURn0ol94M4SAjKa8iW5VowDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQUFAAOCAgEAKvwYZmKDJj6+A7roClEV4UUYLgO3AkOxZahBRIEXbwBSPKvvhHAXe3Vnh+yYsmy3Laq4Lsiehk5boGZ62Az5neljFENSkbr0RQLmE3nGSuuG6wvMVnIjRSC2FR2TD7AkXSxLvFhbZTcPAf6HWEdLlosmVPy6SiffuZk/qOTDsEzJQxEAJ9diV0/0FpR2BtRoJVrPtNPu8XIwLDVuVmCXHpkvFbEbnN1qk7yziooF2VJQ19WOGBIGdiD09S1KSxf37VMtKrrdVZVLxY12Hr7F0Qs6CoLrpe2j07+nBglbxONOrimkCyhXAOy1nUOsvcNEUJPcSo3wU4snlQpG7rdOacmu6HCKIDaxRkAFZwdvLn8BuMDbMfF9xiHLz3CNAqayuXuKv8v+KiKSBZ35it0y9bV2hlGGi+Z7D+wPYoNitzBVuKSvUTcj8+lTMcKy6qD4Axmt/6rrUpLeKJtANvGuHjJt2k6mXuPKJMkd5lmHesOVxCLtfjAWGVJ8jKdjlRh3ldZved7PUJLmVdc3WN174A4ifkVVnJDncYklR85l3Qv6/lnjcRAnVISaCuiQjZ5p7dQ3HcQuXNkrSq3GiCeIaRzvHbyZb+1Jrl82sGD9U5jpMQVyMo3UbCzFZxWFBfLYLLQwmB+yds1UR7I0wjUSVACq8Zr7ZH05R2ChjMEq98M=</l7:Encoded>
                            </l7:CertificateData>
                            <l7:Properties>
                                <l7:Property key="revocationCheckingEnabled">
                                    <l7:BooleanValue>true</l7:BooleanValue>
                                </l7:Property>
                                <l7:Property key="trustAnchor">
                                    <l7:BooleanValue>true</l7:BooleanValue>
                                </l7:Property>
                                <l7:Property key="trustedAsSamlAttestingEntity">
                                    <l7:BooleanValue>true</l7:BooleanValue>
                                </l7:Property>
                                <l7:Property key="trustedAsSamlIssuer">
                                    <l7:BooleanValue>true</l7:BooleanValue>
                                </l7:Property>
                                <l7:Property key="trustedForSigningClientCerts">
                                    <l7:BooleanValue>true</l7:BooleanValue>
                                </l7:Property>
                                <l7:Property key="trustedForSigningServerCerts">
                                    <l7:BooleanValue>true</l7:BooleanValue>
                                </l7:Property>
                                <l7:Property key="trustedForSsl">
                                    <l7:BooleanValue>true</l7:BooleanValue>
                                </l7:Property>
                                <l7:Property key="verifyHostname">
                                    <l7:BooleanValue>false</l7:BooleanValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:TrustedCertificate>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OAuth SAML Identity Provider</l7:Name>
                    <l7:Id>1047c671c8d2cb44c606523f9c1521a3</l7:Id>
                    <l7:Type>ID_PROVIDER_CONFIG</l7:Type>
                    <l7:TimeStamp>2019-05-01T13:46:37.730Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:IdentityProvider id="1047c671c8d2cb44c606523f9c1521a3" version="1">
                            <l7:Name>OAuth SAML Identity Provider</l7:Name>
                            <l7:IdentityProviderType>Federated</l7:IdentityProviderType>
                            <l7:Properties>
                                <l7:Property key="certificateValidation">
                                    <l7:StringValue>Validate Certificate Path</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="enableCredentialType.saml">
                                    <l7:BooleanValue>true</l7:BooleanValue>
                                </l7:Property>
                                <l7:Property key="enableCredentialType.x509">
                                    <l7:BooleanValue>false</l7:BooleanValue>
                                </l7:Property>
                            </l7:Properties>
                            <l7:Extension>
                                <l7:FederatedIdentityProviderDetail>
                                    <l7:CertificateReferences resourceUri="http://ns.l7tech.com/2010/04/gateway-management/trustedCertificates">
                                        <l7:Reference id="8c5ae07247f7a3f5d5fdcc3926f2eeb6"/>
                                    </l7:CertificateReferences>
                                </l7:FederatedIdentityProviderDetail>
                            </l7:Extension>
                        </l7:IdentityProvider>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK grant_type=SAML Authentication</l7:Name>
                    <l7:Id>bc9a31b7578652a08a514d7d4fef3147</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-05-01T13:46:37.734Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="59b9ada1-ac0f-4e8d-a6d4-ddb7544e9eca" id="bc9a31b7578652a08a514d7d4fef3147" version="1">
                            <l7:PolicyDetail folderId="e04ad90cfcec38e51fbe3ed9fe092aef" guid="59b9ada1-ac0f-4e8d-a6d4-ddb7544e9eca" id="bc9a31b7578652a08a514d7d4fef3147" version="1">
                                <l7:Name>OTK grant_type=SAML Authentication</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>2</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;== Target Policy:  &amp;quot;OTK grant_type=SAML&amp;quot;&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;============================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;========== Validate the trusted issuer by adding a FIP here ==========&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;A FIP has to be introduced in order to accept only trusted clients&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Remove the Stop assertion once the FIP is configured&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:FalseAssertion&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;WARNING&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Replace this assertion with a federated identity assertion. Do not just delete it!&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Enabled booleanValue=&quot;false&quot;/&gt;
        &lt;/L7p:FalseAssertion&gt;
        &lt;L7p:Authentication&gt;
            &lt;L7p:IdentityProviderOid goidValue=&quot;1047c671c8d2cb44c606523f9c1521a3&quot;/&gt;
            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;bearerToken&quot;/&gt;
            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
        &lt;/L7p:Authentication&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHtiZWFyZXJUb2tlbi5tYWlucGFydH0=&quot;/&gt;
            &lt;L7p:ContentType stringValue=&quot;text/xml; charset=utf-8&quot;/&gt;
            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;bearerToken&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:ResponseXpathAssertion&gt;
            &lt;L7p:VariablePrefix stringValue=&quot;&quot;/&gt;
            &lt;L7p:XmlMsgSrc stringValue=&quot;bearerToken&quot;/&gt;
            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                &lt;L7p:Expression stringValue=&quot;count(//saml2:Assertion)=1&quot;/&gt;
                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;saml2&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;ds&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;http://www.w3.org/2000/09/xmldsig#&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Namespaces&gt;
                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
            &lt;/L7p:XpathExpression&gt;
        &lt;/L7p:ResponseXpathAssertion&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
            </l7:References>
            <l7:Mappings>
                <l7:Mapping action="NewOrUpdate" srcId="8c5ae07247f7a3f5d5fdcc3926f2eeb6" srcUri="https://mas.docker.local:8443/restman/1.0/trustedCertificates/8c5ae07247f7a3f5d5fdcc3926f2eeb6" type="TRUSTED_CERT"/>
                <l7:Mapping action="NewOrUpdate" srcId="1047c671c8d2cb44c606523f9c1521a3" srcUri="https://mas.docker.local:8443/restman/1.0/identityProviders/1047c671c8d2cb44c606523f9c1521a3" type="ID_PROVIDER_CONFIG"/>
                <l7:Mapping action="NewOrExisting" srcId="e04ad90cfcec38e51fbe3ed9fe092aef" srcUri="https://mas.docker.local:8443/restman/1.0/folders/e04ad90cfcec38e51fbe3ed9fe092aef" type="FOLDER">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrUpdate" srcId="bc9a31b7578652a08a514d7d4fef3147" srcUri="https://mas.docker.local:8443/restman/1.0/policies/bc9a31b7578652a08a514d7d4fef3147" type="POLICY"/>
            </l7:Mappings>
        </l7:Bundle>